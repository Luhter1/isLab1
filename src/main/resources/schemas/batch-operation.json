{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "BatchOperation",
  "description": "Batch Import Operation schema",
  "type": "array",
  "minItems": 1,
  "maxItems": 1024,
  "items": {
    "type": "object",
    "required": ["type", "resourceType"],
    "properties": {
      "type": {
        "type": "string",
        "enum": ["CREATE", "UPDATE", "DELETE"]
      },
      "resourceType": {
        "type": "string",
        "enum": ["coordinates", "dragon-caves", "dragon-heads", "dragons", "locations", "people"]
      },
      "resourceId": {
        "type": "integer",
        "minimum": 1
      },
      "body": {
        "type": "object"
      }
    },
    "allOf": [
      {
        "description": "Rules for CREATE operation (require body, forbid resourceId)",
        "if": { "properties": { "type": { "const": "CREATE" } } },
        "then": {
          "required": ["body"],
          "properties": { "resourceId": { "not": {} } }
        }
      },
      {
        "description": "Rules for UPDATE operation (require body and resourceId)",
        "if": { "properties": { "type": { "const": "UPDATE" } } },
        "then": {
          "required": ["resourceId", "body"],
          "properties": { "body": { "minProperties": 1 } }
        }
      },
      {
        "description": "Rules for DELETE operation (require resourceId, forbid body)",
        "if": { "properties": { "type": { "const": "DELETE" } } },
        "then": {
          "required": ["resourceId"],
          "properties": { "body": { "not": {} } }
        }
      },
      
      
      {
        "description": "Mapping for DRAGONS (Only on CREATE)",
        "if": {
          "properties": {
            "resourceType": { "const": "dragons" },
            "type": { "const": "CREATE" }
          }
        },
        "then": {
          "properties": {
            "body": { "$ref": "classpath:///schemas/dragons.json#/definitions/Dragon" }
          }
        }
      },
      {
        "description": "Mapping for PEOPLE (Only on CREATE)",
        "if": {
          "properties": {
            "resourceType": { "const": "people" },
            "type": { "const": "CREATE" }
          }
        },
        "then": {
          "properties": {
            "body": { "$ref": "classpath:///schemas/people.json#/definitions/Person" }
          }
        }
      },
      {
        "description": "Mapping for COORDINATES (Only on CREATE)",
        "if": {
          "properties": {
            "resourceType": { "const": "coordinates" },
            "type": { "const": "CREATE" }
          }
        },
        "then": {
          "properties": {
            "body": { "$ref": "classpath:///schemas/coordinates.json#/definitions/Coordinate" }
          }
        }
      },
      {
        "description": "Mapping for DRAGON-CAVES (Only on CREATE)",
        "if": {
          "properties": {
            "resourceType": { "const": "dragon-caves" },
            "type": { "const": "CREATE" }
          }
        },
        "then": {
          "properties": {
            "body": { "$ref": "classpath:///schemas/dragon-caves.json#/definitions/DragonCave" }
          }
        }
      },
      {
        "description": "Mapping for DRAGON-HEADS (Only on CREATE)",
        "if": {
          "properties": {
            "resourceType": { "const": "dragon-heads" },
            "type": { "const": "CREATE" }
          }
        },
        "then": {
          "properties": {
            "body": { "$ref": "classpath:///schemas/dragon-heads.json#/definitions/DragonHead" }
          }
        }
      },
      {
        "description": "Mapping for LOCATIONS (Only on CREATE)",
        "if": {
          "properties": {
            "resourceType": { "const": "locations" },
            "type": { "const": "CREATE" }
          }
        },
        "then": {
          "properties": {
            "body": { "$ref": "classpath:///schemas/locations.json#/definitions/Location" }
          }
        }
      }
    ]
  }
}