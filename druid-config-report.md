# Отчёт по конфигурации пула соединений Druid

Пул соединений Alibaba Druid настроен в файле application.properties. Конфигурация ориентирована на режим разработки (dev) с низкой нагрузкой: небольшое количество одновременных запросов, тестирование и отладка. База данных — PostgreSQL (jdbc:postgresql://localhost:5432/studs), локальная, с типичными характеристиками: хорошая производительность на одиночных запросах, но чувствительная к количеству соединений (рекомендуется 10–50 на инстанс в dev). Параметры выбраны консервативно: минимальные ресурсы, стабильность, избежание утечек соединений. Обоснования учитывают низкую нагрузку (1–5 пользователей), частые перезапуски в dev и специфику PostgreSQL (простая валидация, поддержка prepared statements).

## Параметры конфигурации

| Параметр | Значение | Описание | Обоснование |
|----------|----------|----------|-------------|
| druid.initial-size | 5 | Начальное количество соединений в пуле при запуске. | В dev-режиме нагрузка низкая, 5 соединений обеспечивают быстрый старт без ожидания создания новых. Экономит время на инициализацию (~100–500 мс на соединение в PostgreSQL). |
| druid.min-idle | 5 | Минимальное количество неактивных (idle) соединений. | Равно initial-size: поддерживает постоянный минимум для мгновенного ответа на запросы. В dev не тратит ресурсы (PostgreSQL держит ~5–10 idle без overhead). |
| druid.max-active | 20 | Максимальное количество активных соединений. | Хватит для пиковой dev-нагрузки (JMeter-тесты, несколько вкладок). PostgreSQL на localhost выдержит 20 без деградации; в prod можно увеличить до 50–100. |
| druid.max-wait | 60000 (60 с) | Максимальное время ожидания свободного соединения (мс). | Длинный таймаут для dev-отладки (избежать ошибок при медленных запросах). Не блокирует приложение критично. |
| druid.time-between-eviction-runs-millis | 60000 (60 с) | Интервал проверки idle-соединений на eviction (мс). | Стандартный: баланс между timely очисткой и CPU-overhead. В dev с редкими запросами — оптимально. |
| druid.min-evictable-idle-time-millis | 300000 (5 мин) | Минимальное время idle перед возможным закрытием. | Позволяет соединениям "отдыхать" во время пауз в dev (переключение задач). PostgreSQL: предотвращает таймауты сервера. |
| druid.max-evictable-idle-time-millis | 1800000 (30 мин) | Максимальное время idle перед принудительным закрытием. | Длинный срок для dev: соединения не закрываются преждевременно при долгом бездействии (ночные тесты). |
| druid.validation-query | SELECT 1 | SQL-запрос для проверки живости соединения. | Простой, быстрый для PostgreSQL (~1 мс). Стандарт для Postgres, не нагружает БД. |
| druid.test-while-idle | true | Проверка соединения при idle (eviction). | Автоматическая валидация без overhead на borrow/return. Идеально для стабильности в dev. |
| druid.test-on-borrow | false | Проверка при заимствовании соединения. | Отключено для скорости: в dev нагрузка низкая, риски низкие. test-while-idle покрывает. |
| druid.test-on-return | false | Проверка при возврате соединения. | Аналогично: экономия времени, фокус на idle-проверках. |
| druid.pool-prepared-statements | true | Кэширование prepared statements. | Ускоряет повторяющиеся запросы (CRUD в приложении). PostgreSQL оптимизирует PS хорошо. |
| druid.max-pool-prepared-statement-per-connection-size | 20 | Макс. prepared statements на соединение. | Достаточно для типичных CRUD-операций в dev. Не перегружает память. |
